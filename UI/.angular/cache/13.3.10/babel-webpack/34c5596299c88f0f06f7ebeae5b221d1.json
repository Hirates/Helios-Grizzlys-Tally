{"ast":null,"code":"import * as i0 from '@angular/core';\nimport { isDevMode, Directive, Input, Component, NgModule } from '@angular/core';\nimport * as i1 from '@angular/common';\nimport { CommonModule } from '@angular/common';\nimport { __awaiter } from 'tslib';\nimport qrcode from 'qrcode';\n\nfunction QrCodeComponent_canvas_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"canvas\", 1);\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"qrCode\", ctx_r0.value)(\"qrCodeErrorCorrectionLevel\", ctx_r0.errorCorrectionLevel)(\"qrCodeCenterImageSrc\", ctx_r0.centerImageSrc)(\"qrCodeCenterImageWidth\", ctx_r0.centerImageSize)(\"qrCodeCenterImageHeight\", ctx_r0.centerImageSize)(\"qrCodeMargin\", ctx_r0.margin)(\"width\", ctx_r0.size)(\"height\", ctx_r0.size)(\"darkColor\", ctx_r0.darkColor)(\"lightColor\", ctx_r0.lightColor);\n  }\n}\n\nconst validColorRegex = /^#(?:[0-9a-fA-F]{3,4}){1,2}$/;\nlet QrCodeDirective = /*#__PURE__*/(() => {\n  class QrCodeDirective {\n    constructor(viewContainerRef) {\n      this.viewContainerRef = viewContainerRef; // eslint-disable-next-line @angular-eslint/no-input-rename\n\n      this.errorCorrectionLevel = QrCodeDirective.DEFAULT_ERROR_CORRECTION_LEVEL;\n      this.darkColor = \"#000000FF\";\n      this.lightColor = \"#FFFFFFFF\"; // eslint-disable-next-line @angular-eslint/no-input-rename\n\n      this.margin = 16;\n    }\n\n    ngOnChanges() {\n      var _a, _b;\n\n      return __awaiter(this, void 0, void 0, function* () {\n        if (!this.value) {\n          return;\n        }\n\n        if (this.version && this.version > 40) {\n          console.warn(\"[qrCode] max version is 40, clamping\");\n          this.version = 40;\n        } else if (this.version && this.version < 1) {\n          console.warn(\"[qrCode] min version is 1, clamping\");\n          this.version = 1;\n        } else if (this.version !== undefined && isNaN(this.version)) {\n          console.warn(\"[qrCode] version should be set to a number, defaulting to auto\");\n          this.version = undefined;\n        }\n\n        const canvas = this.viewContainerRef.element.nativeElement;\n\n        if (!canvas) {\n          // native element not available on server side rendering\n          return;\n        }\n\n        const context = canvas.getContext(\"2d\");\n\n        if (context) {\n          context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        }\n\n        const errorCorrectionLevel = (_a = this.errorCorrectionLevel) !== null && _a !== void 0 ? _a : QrCodeDirective.DEFAULT_ERROR_CORRECTION_LEVEL;\n        const dark = validColorRegex.test(this.darkColor) ? this.darkColor : undefined;\n        const light = validColorRegex.test(this.lightColor) ? this.lightColor : undefined;\n\n        if (isDevMode()) {\n          if (!dark && this.darkColor) {\n            console.error(\"[ng-qrcode] darkColor set to invalid value, must be RGBA hex color string, eg: #3050A1FF\");\n          }\n\n          if (!light && this.lightColor) {\n            console.error(\"[ng-qrcode] lightColor set to invalid value, must be RGBA hex color string, eg: #3050A130\");\n          }\n        }\n\n        yield qrcode.toCanvas(canvas, this.value, {\n          version: this.version,\n          errorCorrectionLevel,\n          width: this.width,\n          margin: this.margin,\n          color: {\n            dark,\n            light\n          }\n        });\n        const centerImageSrc = this.centerImageSrc;\n        const centerImageWidth = getIntOrDefault(this.centerImageWidth, QrCodeDirective.DEFAULT_CENTER_IMAGE_SIZE);\n        const centerImageHeight = getIntOrDefault(this.centerImageHeight, QrCodeDirective.DEFAULT_CENTER_IMAGE_SIZE);\n\n        if (centerImageSrc && context) {\n          if (!this.centerImage) {\n            this.centerImage = new Image(centerImageWidth, centerImageHeight);\n          }\n\n          if (centerImageSrc !== ((_b = this.centerImage) === null || _b === void 0 ? void 0 : _b.src)) {\n            this.centerImage.src = centerImageSrc;\n          }\n\n          if (centerImageWidth !== this.centerImage.width) {\n            this.centerImage.width = centerImageWidth;\n          }\n\n          if (centerImageHeight !== this.centerImage.height) {\n            this.centerImage.height = centerImageHeight;\n          }\n\n          const centerImage = this.centerImage;\n\n          centerImage.onload = () => {\n            context.drawImage(centerImage, canvas.width / 2 - centerImageWidth / 2, canvas.height / 2 - centerImageHeight / 2, centerImageWidth, centerImageHeight);\n          };\n        }\n      });\n    }\n\n  }\n\n  QrCodeDirective.DEFAULT_ERROR_CORRECTION_LEVEL = \"M\";\n  QrCodeDirective.DEFAULT_CENTER_IMAGE_SIZE = 40;\n\n  QrCodeDirective.ɵfac = function QrCodeDirective_Factory(t) {\n    return new (t || QrCodeDirective)(i0.ɵɵdirectiveInject(i0.ViewContainerRef));\n  };\n\n  QrCodeDirective.ɵdir = /* @__PURE__ */i0.ɵɵdefineDirective({\n    type: QrCodeDirective,\n    selectors: [[\"canvas\", \"qrCode\", \"\"]],\n    inputs: {\n      value: [\"qrCode\", \"value\"],\n      version: [\"qrCodeVersion\", \"version\"],\n      errorCorrectionLevel: [\"qrCodeErrorCorrectionLevel\", \"errorCorrectionLevel\"],\n      width: \"width\",\n      height: \"height\",\n      darkColor: \"darkColor\",\n      lightColor: \"lightColor\",\n      centerImageSrc: [\"qrCodeCenterImageSrc\", \"centerImageSrc\"],\n      centerImageWidth: [\"qrCodeCenterImageWidth\", \"centerImageWidth\"],\n      centerImageHeight: [\"qrCodeCenterImageHeight\", \"centerImageHeight\"],\n      margin: [\"qrCodeMargin\", \"margin\"]\n    },\n    features: [i0.ɵɵNgOnChangesFeature]\n  });\n  return QrCodeDirective;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nfunction getIntOrDefault(value, defaultValue) {\n  if (value === undefined || value === \"\") {\n    return defaultValue;\n  }\n\n  if (typeof value === \"string\") {\n    return parseInt(value, 10);\n  }\n\n  return value;\n}\n\nlet QrCodeComponent = /*#__PURE__*/(() => {\n  class QrCodeComponent {}\n\n  QrCodeComponent.ɵfac = function QrCodeComponent_Factory(t) {\n    return new (t || QrCodeComponent)();\n  };\n\n  QrCodeComponent.ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n    type: QrCodeComponent,\n    selectors: [[\"qr-code\"]],\n    inputs: {\n      value: \"value\",\n      size: \"size\",\n      darkColor: \"darkColor\",\n      lightColor: \"lightColor\",\n      errorCorrectionLevel: \"errorCorrectionLevel\",\n      centerImageSrc: \"centerImageSrc\",\n      centerImageSize: \"centerImageSize\",\n      margin: \"margin\"\n    },\n    decls: 1,\n    vars: 1,\n    consts: [[3, \"qrCode\", \"qrCodeErrorCorrectionLevel\", \"qrCodeCenterImageSrc\", \"qrCodeCenterImageWidth\", \"qrCodeCenterImageHeight\", \"qrCodeMargin\", \"width\", \"height\", \"darkColor\", \"lightColor\", 4, \"ngIf\"], [3, \"qrCode\", \"qrCodeErrorCorrectionLevel\", \"qrCodeCenterImageSrc\", \"qrCodeCenterImageWidth\", \"qrCodeCenterImageHeight\", \"qrCodeMargin\", \"width\", \"height\", \"darkColor\", \"lightColor\"]],\n    template: function QrCodeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, QrCodeComponent_canvas_0_Template, 1, 10, \"canvas\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.value);\n      }\n    },\n    directives: [i1.NgIf, QrCodeDirective],\n    encapsulation: 2\n  });\n  return QrCodeComponent;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nlet QrCodeModule = /*#__PURE__*/(() => {\n  class QrCodeModule {}\n\n  QrCodeModule.ɵfac = function QrCodeModule_Factory(t) {\n    return new (t || QrCodeModule)();\n  };\n\n  QrCodeModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n    type: QrCodeModule\n  });\n  QrCodeModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n    imports: [[CommonModule]]\n  });\n  return QrCodeModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/*\n * Public API Surface of ng-qrcode\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { QrCodeComponent, QrCodeDirective, QrCodeModule };","map":null,"metadata":{},"sourceType":"module"}